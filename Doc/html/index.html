<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Neurolib API Client: Neurolib API Client</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Neurolib API Client
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title"><a class="el" href="namespaceNeurolib.html">Neurolib</a> API Client </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>A .NET client (SDK) for easy use of the <a href="https://www.neurolib.io/">Neurolib</a> recommendation API.</p>
<p>If you don't have an account at <a class="el" href="namespaceNeurolib.html">Neurolib</a> yet, you can create a free account <a href="https://www.neurolib.io/">here</a>.</p>
<p>Documentation of the API can be found at <a href="https://www.neurolib.io/pages/documentation/">www.neurolib.io/pages/documentation</a>.</p>
<h1><a class="anchor" id="autotoc_md1"></a>
Installation</h1>
<p>To install <a class="el" href="namespaceNeurolib_1_1ApiClient.html">Neurolib.ApiClient</a>, run the following command in the Package Manager Console </p><div class="fragment"><div class="line">Install-Package Neurolib.ApiClient</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md2"></a>
Examples</h1>
<h2><a class="anchor" id="autotoc_md3"></a>
Basic example</h2>
<div class="fragment"><div class="line"><span class="keyword">using</span> System;</div>
<div class="line"><span class="keyword">using</span> System.Collections.Generic;</div>
<div class="line"><span class="keyword">using</span> System.Linq;</div>
<div class="line"><span class="keyword">using</span> <a class="code" href="namespaceNeurolib.html">Neurolib</a>.<a class="code" href="namespaceNeurolib_1_1ApiClient.html">ApiClient</a>;</div>
<div class="line"><span class="keyword">using</span> <a class="code" href="namespaceNeurolib.html">Neurolib</a>.<a class="code" href="namespaceNeurolib_1_1ApiClient.html">ApiClient</a>.<a class="code" href="namespaceNeurolib_1_1ApiClient_1_1ApiRequests.html">ApiRequests</a>;</div>
<div class="line"><span class="keyword">using</span> <a class="code" href="namespaceNeurolib.html">Neurolib</a>.<a class="code" href="namespaceNeurolib_1_1ApiClient.html">ApiClient</a>.<a class="code" href="namespaceNeurolib_1_1ApiClient_1_1Bindings.html">Bindings</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">public</span> <span class="keyword">class </span>BasicExample</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">static</span> <span class="keywordtype">int</span> Main(<span class="keywordtype">string</span>[] args)</div>
<div class="line">    {</div>
<div class="line">        NeurolibClient client = <span class="keyword">new</span> NeurolibClient(<span class="stringliteral">&quot;--my-database-id--&quot;</span>, <span class="stringliteral">&quot;--db-private-token--&quot;</span>);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">try</span></div>
<div class="line">        {</div>
<div class="line">            <span class="keyword">const</span> <span class="keywordtype">int</span> NUM = 100;</div>
<div class="line">            var userIds = Enumerable.Range(0, NUM).Select(i =&gt; String.Format(<span class="stringliteral">&quot;user-{0}&quot;</span>, i));</div>
<div class="line">            var itemIds = Enumerable.Range(0, NUM).Select(i =&gt; String.Format(<span class="stringliteral">&quot;item-{0}&quot;</span>, i));</div>
<div class="line">            <span class="comment">// Generate some random purchases of items by users</span></div>
<div class="line">            <span class="keyword">const</span> <span class="keywordtype">double</span> PROBABILITY_PURCHASED = 0.1;</div>
<div class="line">            Random r = <span class="keyword">new</span> Random();</div>
<div class="line">            var purchases = <span class="keyword">new</span> List&lt;Request&gt;();</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">foreach</span>(var userId <span class="keywordflow">in</span> userIds) {</div>
<div class="line">                purchases.AddRange(</div>
<div class="line">                    itemIds.Where(_ =&gt; r.NextDouble() &lt; PROBABILITY_PURCHASED)</div>
<div class="line">                           .Select(itemId =&gt;</div>
<div class="line">                                    <span class="keyword">new</span> AddPurchase(userId, itemId, cascadeCreate: <span class="keyword">true</span>) <span class="comment">// Use cascadeCreate parameter to create</span></div>
<div class="line">                           )                                                             <span class="comment">// the yet non-existing users and items</span></div>
<div class="line">                );</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            Console.WriteLine(<span class="stringliteral">&quot;Send purchases&quot;</span>);</div>
<div class="line">            client.Send(<span class="keyword">new</span> Batch(purchases)); <span class="comment">//Use Batch for faster processing of larger data</span></div>
<div class="line"> </div>
<div class="line">            <span class="comment">// Recommend 5 items for user &#39;user-25&#39;</span></div>
<div class="line">            RecommendationResponse recommendationResponse = client.Send(<span class="keyword">new</span> RecommendItemsToUser(<span class="stringliteral">&quot;user-25&quot;</span>, 5));</div>
<div class="line">            Console.WriteLine(<span class="stringliteral">&quot;Recommended items:&quot;</span>);</div>
<div class="line">            <span class="keywordflow">foreach</span>(Recommendation rec <span class="keywordflow">in</span> recommendationResponse.Recomms) Console.WriteLine(rec.Id);</div>
<div class="line"> </div>
<div class="line">            <span class="comment">// User scrolled down - get next 3 recommended items</span></div>
<div class="line">            recommendationResponse = client.Send(<span class="keyword">new</span> RecommendNextItems(recommendationResponse.RecommId, 3));</div>
<div class="line">            Console.WriteLine(<span class="stringliteral">&quot;Next recommended items:&quot;</span>);</div>
<div class="line">            <span class="keywordflow">foreach</span>(Recommendation rec <span class="keywordflow">in</span> recommendationResponse.Recomms) Console.WriteLine(rec.Id);</div>
<div class="line"> </div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">catch</span>(ApiException e)</div>
<div class="line">        {</div>
<div class="line">         Console.WriteLine(e.ToString());</div>
<div class="line">         <span class="comment">// Use fallback</span></div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md4"></a>
Using property values</h2>
<div class="fragment"><div class="line"><span class="keyword">using</span> System;</div>
<div class="line"><span class="keyword">using</span> System.Threading.Tasks;</div>
<div class="line"><span class="keyword">using</span> System.Collections.Generic;</div>
<div class="line"><span class="keyword">using</span> System.Linq;</div>
<div class="line"><span class="keyword">using</span> <a class="code" href="namespaceNeurolib.html">Neurolib</a>.<a class="code" href="namespaceNeurolib_1_1ApiClient.html">ApiClient</a>;</div>
<div class="line"><span class="keyword">using</span> <a class="code" href="namespaceNeurolib.html">Neurolib</a>.<a class="code" href="namespaceNeurolib_1_1ApiClient.html">ApiClient</a>.<a class="code" href="namespaceNeurolib_1_1ApiClient_1_1ApiRequests.html">ApiRequests</a>;</div>
<div class="line"><span class="keyword">using</span> <a class="code" href="namespaceNeurolib.html">Neurolib</a>.<a class="code" href="namespaceNeurolib_1_1ApiClient.html">ApiClient</a>.<a class="code" href="namespaceNeurolib_1_1ApiClient_1_1Bindings.html">Bindings</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">public</span> <span class="keyword">class </span>PropertiesExample</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">static</span> async Task&lt;int&gt; Main(<span class="keywordtype">string</span>[] args)</div>
<div class="line">    {</div>
<div class="line">        NeurolibClient client = <span class="keyword">new</span> NeurolibClient(<span class="stringliteral">&quot;--my-database-id--&quot;</span>, <span class="stringliteral">&quot;--db-private-token--&quot;</span>);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/*</span></div>
<div class="line"><span class="comment">        We will use computers as items in this example</span></div>
<div class="line"><span class="comment">        Computers have four properties</span></div>
<div class="line"><span class="comment">            - price (floating point number)</span></div>
<div class="line"><span class="comment">            - number of processor cores (integer number)</span></div>
<div class="line"><span class="comment">            - description (string)</span></div>
<div class="line"><span class="comment">            - image (url of computer&#39;s photo)</span></div>
<div class="line"><span class="comment">        */</span></div>
<div class="line"> </div>
<div class="line">         <span class="keywordflow">try</span></div>
<div class="line">         {</div>
<div class="line">            client.Send(<span class="keyword">new</span> ResetDatabase()); <span class="comment">// Clear everything from the database</span></div>
<div class="line">            client.Send(<span class="keyword">new</span> AddItemProperty(<span class="stringliteral">&quot;price&quot;</span>, <span class="stringliteral">&quot;double&quot;</span>));</div>
<div class="line">            client.Send(<span class="keyword">new</span> AddItemProperty(<span class="stringliteral">&quot;num-cores&quot;</span>, <span class="stringliteral">&quot;int&quot;</span>));</div>
<div class="line">            client.Send(<span class="keyword">new</span> AddItemProperty(<span class="stringliteral">&quot;description&quot;</span>, <span class="stringliteral">&quot;string&quot;</span>));</div>
<div class="line">            client.Send(<span class="keyword">new</span> AddItemProperty(<span class="stringliteral">&quot;image&quot;</span>, <span class="stringliteral">&quot;image&quot;</span>));</div>
<div class="line"> </div>
<div class="line">            <span class="comment">// Prepare requests for setting a catalog of computers</span></div>
<div class="line">            var requests = <span class="keyword">new</span> List&lt;Request&gt;();</div>
<div class="line">            <span class="keyword">const</span> <span class="keywordtype">int</span> NUM = 100;</div>
<div class="line">            Random r = <span class="keyword">new</span> Random();</div>
<div class="line">            var itemIds = Enumerable.Range(0, NUM).Select(i =&gt; String.Format(<span class="stringliteral">&quot;computer-{0}&quot;</span>, i));</div>
<div class="line">            <span class="keywordflow">foreach</span>(var itemId <span class="keywordflow">in</span> itemIds)</div>
<div class="line">            {</div>
<div class="line">                var req = <span class="keyword">new</span> SetItemValues(</div>
<div class="line">                    itemId,</div>
<div class="line">                    <span class="comment">//values:</span></div>
<div class="line">                    <span class="keyword">new</span> Dictionary&lt;string, object&gt;() {</div>
<div class="line">                        {<span class="stringliteral">&quot;price&quot;</span>, 600.0 + 400*r.NextDouble()},</div>
<div class="line">                        {<span class="stringliteral">&quot;num-cores&quot;</span>, 1 + r.Next(7)},</div>
<div class="line">                        {<span class="stringliteral">&quot;description&quot;</span>, <span class="stringliteral">&quot;Great computer&quot;</span>},</div>
<div class="line">                        {<span class="stringliteral">&quot;image&quot;</span>, String.Format(<span class="stringliteral">&quot;http://examplesite.com/products/{0}.jpg&quot;</span>, itemId)}</div>
<div class="line">                    },</div>
<div class="line">                    cascadeCreate: <span class="keyword">true</span> <span class="comment">// Use cascadeCreate for creating item</span></div>
<div class="line">                                        <span class="comment">// with given itemId, if it doesn&#39;t exist</span></div>
<div class="line">                );  </div>
<div class="line">                                           </div>
<div class="line">                requests.Add(req);</div>
<div class="line">            }</div>
<div class="line">            await client.SendAsync(<span class="keyword">new</span> Batch(requests)); <span class="comment">// Send catalog to the recommender system</span></div>
<div class="line"> </div>
<div class="line">            <span class="comment">// Generate some random purchases of items by users</span></div>
<div class="line">            var userIds = Enumerable.Range(0, NUM).Select(i =&gt; String.Format(<span class="stringliteral">&quot;user-{0}&quot;</span>, i));</div>
<div class="line">            <span class="keyword">const</span> <span class="keywordtype">double</span> PROBABILITY_PURCHASED = 0.1;</div>
<div class="line">            var purchases = <span class="keyword">new</span> List&lt;Request&gt;();</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">foreach</span>(var userId <span class="keywordflow">in</span> userIds) {</div>
<div class="line">                purchases.AddRange(</div>
<div class="line">                    itemIds.Where(_ =&gt; r.NextDouble() &lt; PROBABILITY_PURCHASED)</div>
<div class="line">                           .Select(itemId =&gt; </div>
<div class="line">                                    <span class="keyword">new</span> AddPurchase(userId, itemId, cascadeCreate: <span class="keyword">true</span>) <span class="comment">// Use cascadeCreate parameter to create</span></div>
<div class="line">                           )                                                             <span class="comment">// the yet non-existing users and items                                                               </span></div>
<div class="line">                );</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            client.Send(<span class="keyword">new</span> Batch(purchases)); <span class="comment">// Send purchases to the recommender system</span></div>
<div class="line">        </div>
<div class="line"> </div>
<div class="line">            <span class="comment">// Get 5 recommendations for user-42, who is currently viewing computer-6</span></div>
<div class="line">            <span class="comment">// Recommend only computers that have at least 3 cores</span></div>
<div class="line">            RecommendationResponse recommendationResponse = await client.SendAsync</div>
<div class="line">                                            (<span class="keyword">new</span> RecommendItemsToItem(<span class="stringliteral">&quot;computer-6&quot;</span>, <span class="stringliteral">&quot;user-42&quot;</span>, 5,</div>
<div class="line">                                                                      filter: <span class="stringliteral">&quot; &#39;num-cores&#39;&gt;=3 &quot;</span>));</div>
<div class="line">            Console.WriteLine(<span class="stringliteral">&quot;Recommended items with at least 3 processor cores:&quot;</span>);</div>
<div class="line">            <span class="keywordflow">foreach</span>(Recommendation rec <span class="keywordflow">in</span> recommendationResponse.Recomms) Console.WriteLine(rec.Id);</div>
<div class="line"> </div>
<div class="line">            <span class="comment">// Recommend only items that are more expensive then currently viewed item (up-sell)</span></div>
<div class="line">            recommendationResponse = await client.SendAsync(<span class="keyword">new</span> RecommendItemsToItem(<span class="stringliteral">&quot;computer-6&quot;</span>, <span class="stringliteral">&quot;user-42&quot;</span>, 5,</div>
<div class="line">                                            filter: <span class="stringliteral">&quot; &#39;price&#39; &gt; context_item[\&quot;price\&quot;] &quot;</span>));</div>
<div class="line">            Console.WriteLine(<span class="stringliteral">&quot;Recommended up-sell items:&quot;</span>);</div>
<div class="line">            <span class="keywordflow">foreach</span>(Recommendation rec <span class="keywordflow">in</span> recommendationResponse.Recomms) Console.WriteLine(rec.Id);</div>
<div class="line"> </div>
<div class="line">            <span class="comment">// Filters, boosters and other settings can be set also in the Admin UI (admin.neurolib.io)</span></div>
<div class="line">            <span class="comment">// when scenario is specified</span></div>
<div class="line">            recommendationResponse = await client.SendAsync(</div>
<div class="line">                <span class="keyword">new</span> RecommendItemsToItem(<span class="stringliteral">&quot;computer-6&quot;</span>, <span class="stringliteral">&quot;user-42&quot;</span>, 5, scenario: <span class="stringliteral">&quot;product_detail&quot;</span>)</div>
<div class="line">            );</div>
<div class="line"> </div>
<div class="line">            <span class="comment">// Perform personalized full-text search with a user&#39;s search query (e.g. &quot;computers&quot;)</span></div>
<div class="line">            SearchResponse searchResponse = await client.SendAsync(</div>
<div class="line">              <span class="keyword">new</span> SearchItems(<span class="stringliteral">&quot;user-42&quot;</span>, <span class="stringliteral">&quot;computers&quot;</span>, 5, scenario: <span class="stringliteral">&quot;search_top&quot;</span>)</div>
<div class="line">            );</div>
<div class="line">            Console.WriteLine(<span class="stringliteral">&quot;Search matches:&quot;</span>);</div>
<div class="line">            <span class="keywordflow">foreach</span>(Recommendation rec <span class="keywordflow">in</span> searchResponse.Recomms) Console.WriteLine(rec.Id);</div>
<div class="line"> </div>
<div class="line">         }</div>
<div class="line">         <span class="keywordflow">catch</span>(ApiException e)</div>
<div class="line">         {</div>
<div class="line">             Console.WriteLine(e.ToString());</div>
<div class="line">             <span class="comment">// Use fallback</span></div>
<div class="line">         }</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md5"></a>
Exception handling</h1>
<p>Various errors can occur while processing request, for example because of adding an already existing item or submitting interaction of nonexistent user without <em>cascadeCreate</em> set to true. These errors lead to throwing the <em>ResponseException</em> by the <em>send</em> method of the client. Another reason for throwing an exception is a timeout. <em>ApiException</em> is the base class of both <em>ResponseException</em> and <em>TimeoutException</em>.</p>
<p>We are doing our best to provide the fastest and most reliable service, but production-level applications must implement a fallback solution since errors can always happen. The fallback might be, for example, showing the most popular items from the current category, or not displaying recommendations at all. </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
<div class="ttc" id="anamespaceNeurolib_1_1ApiClient_html"><div class="ttname"><a href="namespaceNeurolib_1_1ApiClient.html">Neurolib.ApiClient</a></div><div class="ttdef"><b>Definition:</b> ApiException.cs:3</div></div>
<div class="ttc" id="anamespaceNeurolib_1_1ApiClient_1_1Bindings_html"><div class="ttname"><a href="namespaceNeurolib_1_1ApiClient_1_1Bindings.html">Neurolib.ApiClient.Bindings</a></div><div class="ttdef"><b>Definition:</b> BatchResponse.cs:6</div></div>
<div class="ttc" id="anamespaceNeurolib_html"><div class="ttname"><a href="namespaceNeurolib.html">Neurolib</a></div><div class="ttdef"><b>Definition:</b> ApiException.cs:3</div></div>
<div class="ttc" id="anamespaceNeurolib_1_1ApiClient_1_1ApiRequests_html"><div class="ttname"><a href="namespaceNeurolib_1_1ApiClient_1_1ApiRequests.html">Neurolib.ApiClient.ApiRequests</a></div><div class="ttdef"><b>Definition:</b> AddBookmark.cs:12</div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
